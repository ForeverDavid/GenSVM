<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GenSVM: src/gensvm_update.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GenSVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">gensvm_update.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="gensvm__update_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="gensvm__update_8h.html">gensvm_update.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#ifndef GENSVM_BLOCK_SIZE</span></div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#adc5be9293d3b98fd59ad50cc916f4f62">   34</a></span>&#160;<span class="preprocessor">  #define GENSVM_BLOCK_SIZE 512</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069">   56</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069">gensvm_calculate_omega</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordtype">long</span> i)</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">long</span> j;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">double</span> h, omega = 0.0,</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;           <a class="code" href="structGenTask.html#a2343dc48510c367da361fbbdbf759f8d">p</a> = model-&gt;<a class="code" href="structGenModel.html#a5959721cc6fd6aa5bd7d688cecca6e21">p</a>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>; j++) {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordflow">if</span> (j == (data-&gt;<a class="code" href="structGenData.html#a569f63e4b06c3e45240aa1b05a95eea5">y</a>[i]-1))</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        h = <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(model-&gt;<a class="code" href="structGenModel.html#a58e83a9391e4964c503cfe3d4f5bd9bd">H</a>, model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>, i, j);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        omega += pow(h, <a class="code" href="structGenTask.html#a2343dc48510c367da361fbbdbf759f8d">p</a>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    omega = (1.0/<a class="code" href="structGenTask.html#a2343dc48510c367da361fbbdbf759f8d">p</a>)*pow(omega, 1.0/<a class="code" href="structGenTask.html#a2343dc48510c367da361fbbdbf759f8d">p</a> - 1.0);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">return</span> omega;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c">   89</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c">gensvm_majorize_is_simple</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordtype">long</span> i)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">long</span> j;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">double</span> h, value = 0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>; j++) {</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">if</span> (j == (data-&gt;<a class="code" href="structGenData.html#a569f63e4b06c3e45240aa1b05a95eea5">y</a>[i]-1))</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        h = <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(model-&gt;<a class="code" href="structGenModel.html#a58e83a9391e4964c503cfe3d4f5bd9bd">H</a>, model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>, i, j);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        value += (h &gt; 0) ? 1 : 0;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">if</span> (value &gt; 1)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;}</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361">  126</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361">gensvm_calculate_ab_non_simple</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keywordtype">long</span> i, <span class="keywordtype">long</span> j,</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordtype">double</span> *a, <span class="keywordtype">double</span> *b_aq)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordtype">double</span> q = <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(model-&gt;<a class="code" href="structGenModel.html#af22da9befe368b51d369e32b13ab8d71">Q</a>, model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>, i, j);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structGenTask.html#a2343dc48510c367da361fbbdbf759f8d">p</a> = model-&gt;<a class="code" href="structGenModel.html#a5959721cc6fd6aa5bd7d688cecca6e21">p</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structGenTask.html#a31724f1caafe0b1299078a67bf7a08e6">kappa</a> = model-&gt;<a class="code" href="structGenModel.html#a8b2133a50ab35beb1861f2ba3b17cf73">kappa</a>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> a2g2 = 0.25*p*(2.0*p - 1.0)*pow((kappa+1.0)/2.0,p-2.0);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (2.0 - model-&gt;<a class="code" href="structGenModel.html#a5959721cc6fd6aa5bd7d688cecca6e21">p</a> &lt; 1e-2) {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> (q &lt;= - kappa) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            *b_aq = 0.5 - kappa/2.0 - q;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( q &lt;= 1.0) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            *b_aq = pow(1.0 - q, 3.0)/(2.0*pow(kappa + 1.0, 2.0));</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            *b_aq = 0;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        *a = 1.5;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">if</span> (q &lt;= (p + kappa - 1.0)/(p - 2.0)) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            *a = 0.25*pow(p, 2.0)*pow(0.5 - kappa/2.0 - q, p - 2.0);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q &lt;= 1.0) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            *a = a2g2;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            *a = 0.25*pow(p, 2.0)*pow((p/(p - 2.0))*(0.5 -</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                        kappa/2.0 - q), p - 2.0);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            *b_aq = (*a)*(2.0*q + kappa - 1.0)/(p - 2.0) +</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                0.5*p*pow(p/(p - 2.0)*(0.5 - kappa/2.0 - q),</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                        p - 1.0);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (q &lt;= -kappa) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            *b_aq = 0.5*p*pow(0.5 - kappa/2.0 - q, p - 1.0);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( q &lt;= 1.0) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            *b_aq = p*pow(1.0 - q, 2.0*p - 1.0)/pow(2*kappa+2.0, p);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0">  183</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0">gensvm_calculate_ab_simple</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keywordtype">long</span> i, <span class="keywordtype">long</span> j,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordtype">double</span> *a, <span class="keywordtype">double</span> *b_aq)</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">double</span> q = <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(model-&gt;<a class="code" href="structGenModel.html#af22da9befe368b51d369e32b13ab8d71">Q</a>, model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>, i, j);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (q &lt;= - model-&gt;<a class="code" href="structGenTask.html#a31724f1caafe0b1299078a67bf7a08e6">kappa</a>) {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        *a = 0.25/(0.5 - model-&gt;<a class="code" href="structGenModel.html#a8b2133a50ab35beb1861f2ba3b17cf73">kappa</a>/2.0 - q);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        *b_aq = 0.5;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (q &lt;= 1.0) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        *a = 1.0/(2.0*model-&gt;<a class="code" href="structGenModel.html#a8b2133a50ab35beb1861f2ba3b17cf73">kappa</a> + 2.0);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        *b_aq = (1.0 - q)*(*a);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        *a = -0.25/(0.5 - model-&gt;<a class="code" href="structGenModel.html#a8b2133a50ab35beb1861f2ba3b17cf73">kappa</a>/2.0 - q);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        *b_aq = 0;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d">  228</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d">gensvm_get_alpha_beta</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordtype">long</span> i, <span class="keywordtype">double</span> *beta)</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;{</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordtype">bool</span> simple;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">long</span> j, K = model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordtype">double</span> omega, a, b_aq = 0.0,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;           alpha = 0.0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordtype">double</span> *uu_row = NULL;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> in = 1.0/((double) model-&gt;<a class="code" href="structGenModel.html#afa4fe1fb1149aecdcbb7adb0c32e0d5d">n</a>);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    simple = <a class="code" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c">gensvm_majorize_is_simple</a>(model, data, i);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    omega = simple ? 1.0 : <a class="code" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069">gensvm_calculate_omega</a>(model, data, i);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="gensvm__memory_8h.html#a1b21f717efbbd18bd9ab4c448f9d32ed">Memset</a>(beta, <span class="keywordtype">double</span>, K-1);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;K; j++) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="comment">// skip the class y_i = k</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (j == (data-&gt;<a class="code" href="structGenData.html#a569f63e4b06c3e45240aa1b05a95eea5">y</a>[i]-1))</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="comment">// calculate the a_ijk and (b_ijk - a_ijk q_i^(kj)) values</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">if</span> (simple) {</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0">gensvm_calculate_ab_simple</a>(model, i, j, &amp;a, &amp;b_aq);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361">gensvm_calculate_ab_non_simple</a>(model, i, j, &amp;a, &amp;b_aq);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// daxpy on beta and UU</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">// daxpy does: y = a*x + y</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// so y = beta, UU_row = x, a = factor</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        b_aq *= model-&gt;<a class="code" href="structGenModel.html#a28bfa9e93a63cb2e7c9d654ec9cc990b">rho</a>[i] * omega * in;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        uu_row = &amp;model-&gt;<a class="code" href="structGenModel.html#a594baf926be30dad78ab118a277bd165">UU</a>[((data-&gt;<a class="code" href="structGenData.html#a569f63e4b06c3e45240aa1b05a95eea5">y</a>[i]-1)*K+j)*(K-1)];</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        cblas_daxpy(K-1, b_aq, uu_row, 1, beta, 1);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment">// increment Avalue</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        alpha += a;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    alpha *= omega * model-&gt;<a class="code" href="structGenModel.html#a28bfa9e93a63cb2e7c9d654ec9cc990b">rho</a>[i] * in;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span> alpha;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#a21ca55554aabb785a5e0c1d8d73d01c4">  323</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gensvm__update_8c.html#a21ca55554aabb785a5e0c1d8d73d01c4">gensvm_get_update</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">struct</span> <a class="code" href="structGenWork.html">GenWork</a> *work)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">int</span> status;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">long</span> i, j;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">long</span> m = model-&gt;<a class="code" href="structGenModel.html#a8dc5205fdffc64365a291d1f44a50648">m</a>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">long</span> K = model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// compute the ZAZ and ZB matrices</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992">gensvm_get_ZAZ_ZB</a>(model, data, work);</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// Calculate right-hand side of system we want to solve</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// dsymm performs ZB := 1.0 * (ZAZ) * Vbar + 1.0 * ZB</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// the right-hand side is thus stored in ZB after this call</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// Note: LDB and LDC are second dimensions of the matrices due to</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// Row-Major order</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    cblas_dsymm(CblasRowMajor, CblasLeft, CblasUpper, m+1, K-1, 1,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>, m+1, model-&gt;<a class="code" href="structGenModel.html#ad67883533f4bc9cc6672f6e08291c90a">V</a>, K-1, 1.0, work-&gt;<a class="code" href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">ZB</a>, K-1);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// Calculate left-hand side of system we want to solve</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Add lambda to all diagonal elements except the first one. Recall</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// that ZAZ is of size m+1 and is symmetric.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">for</span> (i=m+2; i&lt;=m*(m+2); i+=m+2)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>[i] += model-&gt;<a class="code" href="structGenModel.html#aaecf006ba448c5f6cba27a1fe95527fa">lambda</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Lapack uses column-major order, so we transform the ZB matrix to</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// correspond to this.</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    for (i=0; i&lt;m+1; i++)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;K-1; j++)</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            work-&gt;<a class="code" href="structGenWork.html#a836cb3ad4f7d689b84b494e9214765b4">ZBc</a>[j*(m+1)+i] = work-&gt;<a class="code" href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">ZB</a>[i*(K-1)+j];</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// Solve the system using dposv. Note that above the upper triangular</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// part has always been used in row-major order for ZAZ. This</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// corresponds to the lower triangular part in column-major order.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    status = <a class="code" href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d">dposv</a>(<span class="charliteral">&#39;L&#39;</span>, m+1, K-1, work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>, m+1, work-&gt;<a class="code" href="structGenWork.html#a836cb3ad4f7d689b84b494e9214765b4">ZBc</a>, m+1);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// Use dsysv as fallback, for when the ZAZ matrix is not positive</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="comment">// semi-definite for some reason (perhaps due to rounding errors).</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// This step shouldn&#39;t be necessary but is included for safety.</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (status != 0) {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <a class="code" href="gensvm__print_8h.html#aede5746344fdce99647541101eaa7f06">err</a>(<span class="stringliteral">&quot;[GenSVM Warning]: Received nonzero status from &quot;</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="stringliteral">&quot;dposv: %i\n&quot;</span>, status);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordtype">int</span> *IPIV = <a class="code" href="gensvm__memory_8h.html#a42b132f5e48050417237ad44f03eb4bc">Malloc</a>(<span class="keywordtype">int</span>, m+1);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordtype">double</span> *WORK = <a class="code" href="gensvm__memory_8h.html#a42b132f5e48050417237ad44f03eb4bc">Malloc</a>(<span class="keywordtype">double</span>, 1);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        status = <a class="code" href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5">dsysv</a>(<span class="charliteral">&#39;L&#39;</span>, m+1, K-1, work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>, m+1, IPIV, work-&gt;<a class="code" href="structGenWork.html#a836cb3ad4f7d689b84b494e9214765b4">ZBc</a>,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                m+1, WORK, -1);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordtype">int</span> LWORK = WORK[0];</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        WORK = <a class="code" href="gensvm__memory_8h.html#a47e3717368d9e78bb402e61ed394ac64">Realloc</a>(WORK, <span class="keywordtype">double</span>, LWORK);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        status = <a class="code" href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5">dsysv</a>(<span class="charliteral">&#39;L&#39;</span>, m+1, K-1, work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>, m+1, IPIV, work-&gt;<a class="code" href="structGenWork.html#a836cb3ad4f7d689b84b494e9214765b4">ZBc</a>,</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                m+1, WORK, LWORK);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">if</span> (status != 0)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <a class="code" href="gensvm__print_8h.html#aede5746344fdce99647541101eaa7f06">err</a>(<span class="stringliteral">&quot;[GenSVM Warning]: Received nonzero &quot;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <span class="stringliteral">&quot;status from dsysv: %i\n&quot;</span>, status);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        free(WORK);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        WORK = NULL;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        free(IPIV);</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        IPIV = NULL;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// the solution is now stored in ZBc, in column-major order. Here we</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// convert this back to row-major order</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;m+1; i++)</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;K-1; j++)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            work-&gt;<a class="code" href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">ZB</a>[i*(K-1)+j] = work-&gt;<a class="code" href="structGenWork.html#a836cb3ad4f7d689b84b494e9214765b4">ZBc</a>[j*(m+1)+i];</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// copy the old V to Vbar and the new solution to V</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;m+1; i++) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;K-1; j++) {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <a class="code" href="gensvm__globals_8h.html#a566e6bb4294bfa252bd5043d5116b921">matrix_set</a>(model-&gt;<a class="code" href="structGenModel.html#a094193a9fb6b58bbfa58c951d2394c0e">Vbar</a>, K-1, i, j,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(model-&gt;<a class="code" href="structGenModel.html#ad67883533f4bc9cc6672f6e08291c90a">V</a>, K-1, i, j));</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <a class="code" href="gensvm__globals_8h.html#a566e6bb4294bfa252bd5043d5116b921">matrix_set</a>(model-&gt;<a class="code" href="structGenModel.html#ad67883533f4bc9cc6672f6e08291c90a">V</a>, K-1, i, j,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(work-&gt;<a class="code" href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">ZB</a>, K-1, i, j));</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        }</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6">  418</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6">gensvm_get_ZAZ_ZB_dense</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keyword">struct</span> <a class="code" href="structGenWork.html">GenWork</a> *work)</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">long</span> i;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">double</span> alpha, sqalpha;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">long</span> n = model-&gt;<a class="code" href="structGenModel.html#afa4fe1fb1149aecdcbb7adb0c32e0d5d">n</a>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">long</span> m = model-&gt;<a class="code" href="structGenModel.html#a8dc5205fdffc64365a291d1f44a50648">m</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordtype">long</span> K = model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="comment">// generate Z&#39;*A*Z and Z&#39;*B by rank 1 operations</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;n; i++) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        alpha = <a class="code" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d">gensvm_get_alpha_beta</a>(model, data, i, work-&gt;<a class="code" href="structGenWork.html#a6061fc382a543759e273dc5851f8313a">beta</a>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// calculate row of matrix LZ, which is a scalar</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="comment">// multiplication of sqrt(alpha_i) and row z_i&#39; of Z</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">// Note that we use the fact that the first column of Z is</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="comment">// always 1, by only computing the product for m values and</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <span class="comment">// copying the first element over.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        sqalpha = sqrt(alpha);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        work-&gt;<a class="code" href="structGenWork.html#a964639af134182df272161553c28a52b">LZ</a>[i*(m+1)] = sqalpha;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        cblas_daxpy(m, sqalpha, &amp;data-&gt;<a class="code" href="structGenData.html#a09551353e78c992c99e5ea8145da4b69">Z</a>[i*(m+1)+1], 1,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                &amp;work-&gt;<a class="code" href="structGenWork.html#a964639af134182df272161553c28a52b">LZ</a>[i*(m+1)+1], 1);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// rank 1 update of matrix Z&#39;*B</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="comment">// Note: LDA is the second dimension of ZB because of</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="comment">// Row-Major order</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        cblas_dger(CblasRowMajor, m+1, K-1, 1, &amp;data-&gt;<a class="code" href="structGenData.html#a09551353e78c992c99e5ea8145da4b69">Z</a>[i*(m+1)], 1,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                work-&gt;<a class="code" href="structGenWork.html#a6061fc382a543759e273dc5851f8313a">beta</a>, 1, work-&gt;<a class="code" href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">ZB</a>, K-1);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// calculate Z&#39;*A*Z by symmetric multiplication of LZ with itself</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// (ZAZ = (LZ)&#39; * (LZ)</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    cblas_dsyrk(CblasRowMajor, CblasUpper, CblasTrans, m+1, n, 1.0,</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            work-&gt;<a class="code" href="structGenWork.html#a964639af134182df272161553c28a52b">LZ</a>, m+1, 0.0, work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>, m+1);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524">  481</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524">gensvm_get_ZAZ_ZB_sparse</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keyword">struct</span> <a class="code" href="structGenWork.html">GenWork</a> *work)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordtype">long</span> *Zia = NULL,</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;         *Zja = NULL;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordtype">long</span> b, i, j, k, K, jj, kk, jj_start, jj_end, blk_start, blk_end,</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;         rem_size, n_blocks, n_row = data-&gt;<a class="code" href="structGenData.html#af2cdf64f8737cc7aacc91cff3bb11a19">spZ</a>-&gt;<a class="code" href="structGenSparse.html#a6c6ac93cce7088fcc0bbf5e3cc4fca23">n_row</a>,</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         n_col = data-&gt;<a class="code" href="structGenData.html#af2cdf64f8737cc7aacc91cff3bb11a19">spZ</a>-&gt;<a class="code" href="structGenSparse.html#af61b276f6b582e60885f4449526a0ed9">n_col</a>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">double</span> temp, alpha, z_ij, *vals = NULL;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    K = model-&gt;<a class="code" href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">K</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    Zia = data-&gt;<a class="code" href="structGenData.html#af2cdf64f8737cc7aacc91cff3bb11a19">spZ</a>-&gt;<a class="code" href="structGenSparse.html#aa1b9b81e44091352238fe30aced42cae">ia</a>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    Zja = data-&gt;<a class="code" href="structGenData.html#af2cdf64f8737cc7aacc91cff3bb11a19">spZ</a>-&gt;<a class="code" href="structGenSparse.html#aee2b2c98c8ff98e2667f3b19d4b32500">ja</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    vals = data-&gt;<a class="code" href="structGenData.html#af2cdf64f8737cc7aacc91cff3bb11a19">spZ</a>-&gt;<a class="code" href="structGenSparse.html#af4b6bd8a48f59c0d0b425400369fbc87">values</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// calculate ZAZ using blocks of rows of Z. This helps avoiding </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// rounding errors, which increases precision, and in turn helps </span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// convergence of the IM algorithm.</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// see also: http://stackoverflow.com/q/40286989/</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    n_blocks = floor(n_row / <a class="code" href="gensvm__update_8c.html#adc5be9293d3b98fd59ad50cc916f4f62">GENSVM_BLOCK_SIZE</a>);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    rem_size = n_row % <a class="code" href="gensvm__update_8c.html#adc5be9293d3b98fd59ad50cc916f4f62">GENSVM_BLOCK_SIZE</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">for</span> (b=0; b&lt;=n_blocks; b++) {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        blk_start = b * <a class="code" href="gensvm__update_8c.html#adc5be9293d3b98fd59ad50cc916f4f62">GENSVM_BLOCK_SIZE</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        blk_end = blk_start;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        blk_end += (b == n_blocks) ? rem_size : GENSVM_BLOCK_SIZE;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <a class="code" href="gensvm__memory_8h.html#a1b21f717efbbd18bd9ab4c448f9d32ed">Memset</a>(work-&gt;<a class="code" href="structGenWork.html#afcbeccb46033f3c7b1222e73ab79589c">tmpZAZ</a>, <span class="keywordtype">double</span>, n_col*n_col);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">for</span> (i=blk_start; i&lt;blk_end; i++) {</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            alpha = <a class="code" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d">gensvm_get_alpha_beta</a>(model, data, i, </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    work-&gt;<a class="code" href="structGenWork.html#a6061fc382a543759e273dc5851f8313a">beta</a>);</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            jj_start = Zia[i];</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            jj_end = Zia[i+1];</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">for</span> (jj=jj_start; jj&lt;jj_end; jj++) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                j = Zja[jj];</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                z_ij = vals[jj];</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                cblas_daxpy(K-1, z_ij, work-&gt;<a class="code" href="structGenWork.html#a6061fc382a543759e273dc5851f8313a">beta</a>, 1,</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        &amp;work-&gt;<a class="code" href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">ZB</a>[j*(K-1)], 1);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                z_ij *= alpha;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">for</span> (kk=jj; kk&lt;jj_end; kk++) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    <a class="code" href="gensvm__globals_8h.html#a2444a1b8bce2412b7374c64218450639">matrix_add</a>(work-&gt;<a class="code" href="structGenWork.html#afcbeccb46033f3c7b1222e73ab79589c">tmpZAZ</a>, n_col, j, </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                            Zja[kk], </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                            z_ij * vals[kk]);</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        }</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">// copy the intermediate results over to the actual ZAZ matrix</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;n_col; j++) {</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordflow">for</span> (k=j; k&lt;n_col; k++) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                temp = <a class="code" href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a>(work-&gt;<a class="code" href="structGenWork.html#afcbeccb46033f3c7b1222e73ab79589c">tmpZAZ</a>, n_col, j, k);</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <a class="code" href="gensvm__globals_8h.html#a2444a1b8bce2412b7374c64218450639">matrix_add</a>(work-&gt;<a class="code" href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">ZAZ</a>, n_col, j, k, temp);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        }</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;}</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992">  553</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992">gensvm_get_ZAZ_ZB</a>(<span class="keyword">struct</span> <a class="code" href="structGenModel.html">GenModel</a> *model, <span class="keyword">struct</span> <a class="code" href="structGenData.html">GenData</a> *data,</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keyword">struct</span> <a class="code" href="structGenWork.html">GenWork</a> *work)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;{</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="gensvm__base_8h.html#a866ddca7070aacee709a6cfd563a595f">gensvm_reset_work</a>(work);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (data-&gt;<a class="code" href="structGenData.html#a09551353e78c992c99e5ea8145da4b69">Z</a> == NULL)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524">gensvm_get_ZAZ_ZB_sparse</a>(model, data, work);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6">gensvm_get_ZAZ_ZB_dense</a>(model, data, work);</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d">  593</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d">dposv</a>(<span class="keywordtype">char</span> UPLO, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> NRHS, <span class="keywordtype">double</span> *A, <span class="keywordtype">int</span> LDA, <span class="keywordtype">double</span> *B,</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">int</span> LDB)</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;{</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> dposv_(<span class="keywordtype">char</span> *UPLO, <span class="keywordtype">int</span> *Np, <span class="keywordtype">int</span> *NRHSp, <span class="keywordtype">double</span> *A,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keywordtype">int</span> *LDAp, <span class="keywordtype">double</span> *B, <span class="keywordtype">int</span> *LDBp, <span class="keywordtype">int</span> *INFOp);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">int</span> INFO;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    dposv_(&amp;UPLO, &amp;N, &amp;NRHS, A, &amp;LDA, B, &amp;LDB, &amp;INFO);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">return</span> INFO;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;}</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5">  638</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5">dsysv</a>(<span class="keywordtype">char</span> UPLO, <span class="keywordtype">int</span> N, <span class="keywordtype">int</span> NRHS, <span class="keywordtype">double</span> *A, <span class="keywordtype">int</span> LDA, <span class="keywordtype">int</span> *IPIV,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        <span class="keywordtype">double</span> *B, <span class="keywordtype">int</span> LDB, <span class="keywordtype">double</span> *WORK, <span class="keywordtype">int</span> LWORK)</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;{</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">extern</span> <span class="keywordtype">void</span> dsysv_(<span class="keywordtype">char</span> *UPLO, <span class="keywordtype">int</span> *Np, <span class="keywordtype">int</span> *NRHSp, <span class="keywordtype">double</span> *A,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordtype">int</span> *LDAp, <span class="keywordtype">int</span> *IPIV, <span class="keywordtype">double</span> *B, <span class="keywordtype">int</span> *LDBp,</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <span class="keywordtype">double</span> *WORK, <span class="keywordtype">int</span> *LWORK, <span class="keywordtype">int</span> *INFOp);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">int</span> INFO;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    dsysv_(&amp;UPLO, &amp;N, &amp;NRHS, A, &amp;LDA, IPIV, B, &amp;LDB, WORK, &amp;LWORK, &amp;INFO);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">return</span> INFO;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;}</div><div class="ttc" id="structGenModel_html_a58e83a9391e4964c503cfe3d4f5bd9bd"><div class="ttname"><a href="structGenModel.html#a58e83a9391e4964c503cfe3d4f5bd9bd">GenModel::H</a></div><div class="ttdeci">double * H</div><div class="ttdoc">Huber weighted error matrix. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00115">gensvm_base.h:115</a></div></div>
<div class="ttc" id="structGenWork_html_a964639af134182df272161553c28a52b"><div class="ttname"><a href="structGenWork.html#a964639af134182df272161553c28a52b">GenWork::LZ</a></div><div class="ttdeci">double * LZ</div><div class="ttdoc">n x (m+1) working matrix for the Z&amp;#39;*A*Z calculation </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00144">gensvm_base.h:144</a></div></div>
<div class="ttc" id="structGenSparse_html_aee2b2c98c8ff98e2667f3b19d4b32500"><div class="ttname"><a href="structGenSparse.html#aee2b2c98c8ff98e2667f3b19d4b32500">GenSparse::ja</a></div><div class="ttdeci">long * ja</div><div class="ttdoc">column indices, should be of length nnz </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__sparse_8h_source.html#l00067">gensvm_sparse.h:67</a></div></div>
<div class="ttc" id="structGenSparse_html_af61b276f6b582e60885f4449526a0ed9"><div class="ttname"><a href="structGenSparse.html#af61b276f6b582e60885f4449526a0ed9">GenSparse::n_col</a></div><div class="ttdeci">long n_col</div><div class="ttdoc">number of columns of the original matrix </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__sparse_8h_source.html#l00060">gensvm_sparse.h:60</a></div></div>
<div class="ttc" id="gensvm__print_8h_html_aede5746344fdce99647541101eaa7f06"><div class="ttname"><a href="gensvm__print_8h.html#aede5746344fdce99647541101eaa7f06">err</a></div><div class="ttdeci">void err(const char *fmt,...)</div><div class="ttdoc">Parse a formatted string and write it to standard error. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__print_8c_source.html#l00084">gensvm_print.c:84</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_a762bfc3b570c8c1007dd0c8d8a27ae0d"><div class="ttname"><a href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d">dposv</a></div><div class="ttdeci">int dposv(char UPLO, int N, int NRHS, double *A, int LDA, double *B, int LDB)</div><div class="ttdoc">Solve AX = B where A is symmetric positive definite. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00593">gensvm_update.c:593</a></div></div>
<div class="ttc" id="structGenModel_html_a5959721cc6fd6aa5bd7d688cecca6e21"><div class="ttname"><a href="structGenModel.html#a5959721cc6fd6aa5bd7d688cecca6e21">GenModel::p</a></div><div class="ttdeci">double p</div><div class="ttdoc">parameter for the L-p norm in the loss function </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00098">gensvm_base.h:98</a></div></div>
<div class="ttc" id="structGenModel_html_a594baf926be30dad78ab118a277bd165"><div class="ttname"><a href="structGenModel.html#a594baf926be30dad78ab118a277bd165">GenModel::UU</a></div><div class="ttdeci">double * UU</div><div class="ttdoc">simplex difference matrix </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00111">gensvm_base.h:111</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_a9218875737267254fc332d772ce13ec0"><div class="ttname"><a href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0">gensvm_calculate_ab_simple</a></div><div class="ttdeci">void gensvm_calculate_ab_simple(struct GenModel *model, long i, long j, double *a, double *b_aq)</div><div class="ttdoc">Compute majorization coefficients for simple instances. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00183">gensvm_update.c:183</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_abb108fbbbf27aedec726d363683bdb1c"><div class="ttname"><a href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c">gensvm_majorize_is_simple</a></div><div class="ttdeci">bool gensvm_majorize_is_simple(struct GenModel *model, struct GenData *data, long i)</div><div class="ttdoc">Check if we can do simple majorization for a given instance. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00089">gensvm_update.c:89</a></div></div>
<div class="ttc" id="gensvm__memory_8h_html_a1b21f717efbbd18bd9ab4c448f9d32ed"><div class="ttname"><a href="gensvm__memory_8h.html#a1b21f717efbbd18bd9ab4c448f9d32ed">Memset</a></div><div class="ttdeci">#define Memset(var, type, size)</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__memory_8h_source.html#l00061">gensvm_memory.h:61</a></div></div>
<div class="ttc" id="gensvm__globals_8h_html_a647406850fa178d8787d9ee3901c7df0"><div class="ttname"><a href="gensvm__globals_8h.html#a647406850fa178d8787d9ee3901c7df0">matrix_get</a></div><div class="ttdeci">#define matrix_get(M, cols, i, j)</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__globals_8h_source.html#l00111">gensvm_globals.h:111</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_a21ca55554aabb785a5e0c1d8d73d01c4"><div class="ttname"><a href="gensvm__update_8c.html#a21ca55554aabb785a5e0c1d8d73d01c4">gensvm_get_update</a></div><div class="ttdeci">void gensvm_get_update(struct GenModel *model, struct GenData *data, struct GenWork *work)</div><div class="ttdoc">Perform a single step of the majorization algorithm to update V. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00323">gensvm_update.c:323</a></div></div>
<div class="ttc" id="structGenData_html_a09551353e78c992c99e5ea8145da4b69"><div class="ttname"><a href="structGenData.html#a09551353e78c992c99e5ea8145da4b69">GenData::Z</a></div><div class="ttdeci">double * Z</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00066">gensvm_base.h:66</a></div></div>
<div class="ttc" id="structGenWork_html"><div class="ttname"><a href="structGenWork.html">GenWork</a></div><div class="ttdoc">A structure to hold the GenSVM workspace. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00136">gensvm_base.h:136</a></div></div>
<div class="ttc" id="structGenWork_html_a836cb3ad4f7d689b84b494e9214765b4"><div class="ttname"><a href="structGenWork.html#a836cb3ad4f7d689b84b494e9214765b4">GenWork::ZBc</a></div><div class="ttdeci">double * ZBc</div><div class="ttdoc">(K-1) x (m+1) working matrix for the Z&amp;#39;*B calculation </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00148">gensvm_base.h:148</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_ae51dd734ea3e73944d9eb890d63cb361"><div class="ttname"><a href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361">gensvm_calculate_ab_non_simple</a></div><div class="ttdeci">void gensvm_calculate_ab_non_simple(struct GenModel *model, long i, long j, double *a, double *b_aq)</div><div class="ttdoc">Compute majorization coefficients for non-simple instance. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00126">gensvm_update.c:126</a></div></div>
<div class="ttc" id="gensvm__memory_8h_html_a42b132f5e48050417237ad44f03eb4bc"><div class="ttname"><a href="gensvm__memory_8h.html#a42b132f5e48050417237ad44f03eb4bc">Malloc</a></div><div class="ttdeci">#define Malloc(type, size)</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__memory_8h_source.html#l00048">gensvm_memory.h:48</a></div></div>
<div class="ttc" id="structGenModel_html_ad67883533f4bc9cc6672f6e08291c90a"><div class="ttname"><a href="structGenModel.html#ad67883533f4bc9cc6672f6e08291c90a">GenModel::V</a></div><div class="ttdeci">double * V</div><div class="ttdoc">augmented weight matrix </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00104">gensvm_base.h:104</a></div></div>
<div class="ttc" id="gensvm__globals_8h_html_a2444a1b8bce2412b7374c64218450639"><div class="ttname"><a href="gensvm__globals_8h.html#a2444a1b8bce2412b7374c64218450639">matrix_add</a></div><div class="ttdeci">#define matrix_add(M, cols, i, j, val)</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__globals_8h_source.html#l00116">gensvm_globals.h:116</a></div></div>
<div class="ttc" id="structGenModel_html_af22da9befe368b51d369e32b13ab8d71"><div class="ttname"><a href="structGenModel.html#af22da9befe368b51d369e32b13ab8d71">GenModel::Q</a></div><div class="ttdeci">double * Q</div><div class="ttdoc">error matrix </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00113">gensvm_base.h:113</a></div></div>
<div class="ttc" id="structGenWork_html_a768aca6908ae281e1115758c89d5fcf1"><div class="ttname"><a href="structGenWork.html#a768aca6908ae281e1115758c89d5fcf1">GenWork::ZAZ</a></div><div class="ttdeci">double * ZAZ</div><div class="ttdoc">(m+1) x (m+1) working matrix for the Z&amp;#39;*A*Z calculation </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00150">gensvm_base.h:150</a></div></div>
<div class="ttc" id="structGenData_html_a569f63e4b06c3e45240aa1b05a95eea5"><div class="ttname"><a href="structGenData.html#a569f63e4b06c3e45240aa1b05a95eea5">GenData::y</a></div><div class="ttdeci">long * y</div><div class="ttdoc">array of class labels, 1..K </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00064">gensvm_base.h:64</a></div></div>
<div class="ttc" id="structGenData_html"><div class="ttname"><a href="structGenData.html">GenData</a></div><div class="ttdoc">A structure to represent the data. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00055">gensvm_base.h:55</a></div></div>
<div class="ttc" id="structGenSparse_html_af4b6bd8a48f59c0d0b425400369fbc87"><div class="ttname"><a href="structGenSparse.html#af4b6bd8a48f59c0d0b425400369fbc87">GenSparse::values</a></div><div class="ttdeci">double * values</div><div class="ttdoc">actual nonzero values, should be of length nnz </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__sparse_8h_source.html#l00063">gensvm_sparse.h:63</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_a9949f0ec9eae2316998136a89aeb2992"><div class="ttname"><a href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992">gensvm_get_ZAZ_ZB</a></div><div class="ttdeci">void gensvm_get_ZAZ_ZB(struct GenModel *model, struct GenData *data, struct GenWork *work)</div><div class="ttdoc">Wrapper around calculation of Z&amp;#39;*A*Z and Z&amp;#39;*B for sparse and dense. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00553">gensvm_update.c:553</a></div></div>
<div class="ttc" id="structGenModel_html"><div class="ttname"><a href="structGenModel.html">GenModel</a></div><div class="ttdoc">A structure to represent a single GenSVM model. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00087">gensvm_base.h:87</a></div></div>
<div class="ttc" id="gensvm__base_8h_html_a866ddca7070aacee709a6cfd563a595f"><div class="ttname"><a href="gensvm__base_8h.html#a866ddca7070aacee709a6cfd563a595f">gensvm_reset_work</a></div><div class="ttdeci">void gensvm_reset_work(struct GenWork *work)</div><div class="ttdoc">Reset all matrices of a GenWork instance. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8c_source.html#l00296">gensvm_base.c:296</a></div></div>
<div class="ttc" id="structGenWork_html_ac3bebeaeccd57c2dd946b7826a9b8ac5"><div class="ttname"><a href="structGenWork.html#ac3bebeaeccd57c2dd946b7826a9b8ac5">GenWork::ZB</a></div><div class="ttdeci">double * ZB</div><div class="ttdoc">(m+1) x (K-1) working matrix for the Z&amp;#39;*B calculation </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00146">gensvm_base.h:146</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_ac5dcf6daf6e1e1888f0a97f501037524"><div class="ttname"><a href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524">gensvm_get_ZAZ_ZB_sparse</a></div><div class="ttdeci">void gensvm_get_ZAZ_ZB_sparse(struct GenModel *model, struct GenData *data, struct GenWork *work)</div><div class="ttdoc">Calculate Z&amp;#39;*A*Z and Z&amp;#39;*B for sparse matrices. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00481">gensvm_update.c:481</a></div></div>
<div class="ttc" id="gensvm__memory_8h_html_a47e3717368d9e78bb402e61ed394ac64"><div class="ttname"><a href="gensvm__memory_8h.html#a47e3717368d9e78bb402e61ed394ac64">Realloc</a></div><div class="ttdeci">#define Realloc(var, type, size)</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__memory_8h_source.html#l00055">gensvm_memory.h:55</a></div></div>
<div class="ttc" id="structGenModel_html_a094193a9fb6b58bbfa58c951d2394c0e"><div class="ttname"><a href="structGenModel.html#a094193a9fb6b58bbfa58c951d2394c0e">GenModel::Vbar</a></div><div class="ttdeci">double * Vbar</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00106">gensvm_base.h:106</a></div></div>
<div class="ttc" id="structGenWork_html_afcbeccb46033f3c7b1222e73ab79589c"><div class="ttname"><a href="structGenWork.html#afcbeccb46033f3c7b1222e73ab79589c">GenWork::tmpZAZ</a></div><div class="ttdeci">double * tmpZAZ</div><div class="ttdoc">(m+1) x (m+1) temporary working matrix for the Z&amp;#39;*A*Z calculation </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00152">gensvm_base.h:152</a></div></div>
<div class="ttc" id="structGenModel_html_afa4fe1fb1149aecdcbb7adb0c32e0d5d"><div class="ttname"><a href="structGenModel.html#afa4fe1fb1149aecdcbb7adb0c32e0d5d">GenModel::n</a></div><div class="ttdeci">long n</div><div class="ttdoc">number of instances in the dataset </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00092">gensvm_base.h:92</a></div></div>
<div class="ttc" id="gensvm__update_8h_html"><div class="ttname"><a href="gensvm__update_8h.html">gensvm_update.h</a></div><div class="ttdoc">Header file for gensvm_update.c. </div></div>
<div class="ttc" id="gensvm__update_8c_html_a015783619d7f097db396c176e0ff99a5"><div class="ttname"><a href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5">dsysv</a></div><div class="ttdeci">int dsysv(char UPLO, int N, int NRHS, double *A, int LDA, int *IPIV, double *B, int LDB, double *WORK, int LWORK)</div><div class="ttdoc">Solve a system of equations AX = B where A is symmetric. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00638">gensvm_update.c:638</a></div></div>
<div class="ttc" id="structGenModel_html_a28bfa9e93a63cb2e7c9d654ec9cc990b"><div class="ttname"><a href="structGenModel.html#a28bfa9e93a63cb2e7c9d654ec9cc990b">GenModel::rho</a></div><div class="ttdeci">double * rho</div><div class="ttdoc">vector of instance weights </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00117">gensvm_base.h:117</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_ae90a65a5a2a2313251356d3667a8b069"><div class="ttname"><a href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069">gensvm_calculate_omega</a></div><div class="ttdeci">double gensvm_calculate_omega(struct GenModel *model, struct GenData *data, long i)</div><div class="ttdoc">Calculate the value of omega for a single instance. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00056">gensvm_update.c:56</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_aeb327efd218c706102916bb0aa1e671d"><div class="ttname"><a href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d">gensvm_get_alpha_beta</a></div><div class="ttdeci">double gensvm_get_alpha_beta(struct GenModel *model, struct GenData *data, long i, double *beta)</div><div class="ttdoc">Compute the alpha_i and beta_i for an instance. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00228">gensvm_update.c:228</a></div></div>
<div class="ttc" id="structGenModel_html_a8b2133a50ab35beb1861f2ba3b17cf73"><div class="ttname"><a href="structGenModel.html#a8b2133a50ab35beb1861f2ba3b17cf73">GenModel::kappa</a></div><div class="ttdeci">double kappa</div><div class="ttdoc">parameter for the Huber hinge function </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00100">gensvm_base.h:100</a></div></div>
<div class="ttc" id="structGenModel_html_a19f45ab1c73e075dbabf29b3432dc166"><div class="ttname"><a href="structGenModel.html#a19f45ab1c73e075dbabf29b3432dc166">GenModel::K</a></div><div class="ttdeci">long K</div><div class="ttdoc">number of classes in the dataset </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00090">gensvm_base.h:90</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_ab695778b8a796f3f991754ed0015eeb6"><div class="ttname"><a href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6">gensvm_get_ZAZ_ZB_dense</a></div><div class="ttdeci">void gensvm_get_ZAZ_ZB_dense(struct GenModel *model, struct GenData *data, struct GenWork *work)</div><div class="ttdoc">Calculate Z&amp;#39;*A*Z and Z&amp;#39;*B for dense matrices. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00418">gensvm_update.c:418</a></div></div>
<div class="ttc" id="structGenTask_html_a31724f1caafe0b1299078a67bf7a08e6"><div class="ttname"><a href="structGenTask.html#a31724f1caafe0b1299078a67bf7a08e6">GenTask::kappa</a></div><div class="ttdeci">double kappa</div><div class="ttdoc">kappa parameter for the GenModel </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__task_8h_source.html#l00064">gensvm_task.h:64</a></div></div>
<div class="ttc" id="gensvm__globals_8h_html_a566e6bb4294bfa252bd5043d5116b921"><div class="ttname"><a href="gensvm__globals_8h.html#a566e6bb4294bfa252bd5043d5116b921">matrix_set</a></div><div class="ttdeci">#define matrix_set(M, cols, i, j, val)</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__globals_8h_source.html#l00106">gensvm_globals.h:106</a></div></div>
<div class="ttc" id="gensvm__update_8c_html_adc5be9293d3b98fd59ad50cc916f4f62"><div class="ttname"><a href="gensvm__update_8c.html#adc5be9293d3b98fd59ad50cc916f4f62">GENSVM_BLOCK_SIZE</a></div><div class="ttdeci">#define GENSVM_BLOCK_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gensvm__update_8c_source.html#l00034">gensvm_update.c:34</a></div></div>
<div class="ttc" id="structGenModel_html_a8dc5205fdffc64365a291d1f44a50648"><div class="ttname"><a href="structGenModel.html#a8dc5205fdffc64365a291d1f44a50648">GenModel::m</a></div><div class="ttdeci">long m</div><div class="ttdoc">number of predictor variables in the dataset </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00094">gensvm_base.h:94</a></div></div>
<div class="ttc" id="structGenSparse_html_aa1b9b81e44091352238fe30aced42cae"><div class="ttname"><a href="structGenSparse.html#aa1b9b81e44091352238fe30aced42cae">GenSparse::ia</a></div><div class="ttdeci">long * ia</div><div class="ttdoc">cumulative row lengths, should be of length n_row+1 </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__sparse_8h_source.html#l00065">gensvm_sparse.h:65</a></div></div>
<div class="ttc" id="structGenData_html_af2cdf64f8737cc7aacc91cff3bb11a19"><div class="ttname"><a href="structGenData.html#af2cdf64f8737cc7aacc91cff3bb11a19">GenData::spZ</a></div><div class="ttdeci">struct GenSparse * spZ</div><div class="ttdoc">sparse representation of the augmented data matrix </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00069">gensvm_base.h:69</a></div></div>
<div class="ttc" id="structGenWork_html_a6061fc382a543759e273dc5851f8313a"><div class="ttname"><a href="structGenWork.html#a6061fc382a543759e273dc5851f8313a">GenWork::beta</a></div><div class="ttdeci">double * beta</div><div class="ttdoc">K-1 working vector for a row of the B matrix. </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00156">gensvm_base.h:156</a></div></div>
<div class="ttc" id="structGenTask_html_a2343dc48510c367da361fbbdbf759f8d"><div class="ttname"><a href="structGenTask.html#a2343dc48510c367da361fbbdbf759f8d">GenTask::p</a></div><div class="ttdeci">double p</div><div class="ttdoc">p parameter for the GenModel </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__task_8h_source.html#l00062">gensvm_task.h:62</a></div></div>
<div class="ttc" id="structGenModel_html_aaecf006ba448c5f6cba27a1fe95527fa"><div class="ttname"><a href="structGenModel.html#aaecf006ba448c5f6cba27a1fe95527fa">GenModel::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">regularization parameter in the loss function </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__base_8h_source.html#l00102">gensvm_base.h:102</a></div></div>
<div class="ttc" id="structGenSparse_html_a6c6ac93cce7088fcc0bbf5e3cc4fca23"><div class="ttname"><a href="structGenSparse.html#a6c6ac93cce7088fcc0bbf5e3cc4fca23">GenSparse::n_row</a></div><div class="ttdeci">long n_row</div><div class="ttdoc">number of rows of the original matrix </div><div class="ttdef"><b>Definition:</b> <a href="gensvm__sparse_8h_source.html#l00058">gensvm_sparse.h:58</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 12 2017 14:06:18 for GenSVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
