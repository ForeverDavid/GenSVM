<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GenSVM: src/gensvm_update.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GenSVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gensvm_update.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for getting an update of the majorization algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="gensvm__update_8h_source.html">gensvm_update.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gensvm_update.c:</div>
<div class="dyncontent">
<div class="center"><img src="gensvm__update_8c__incl.png" border="0" usemap="#src_2gensvm__update_8c" alt=""/></div>
<map name="src_2gensvm__update_8c" id="src_2gensvm__update_8c">
<area shape="rect" id="node2" href="gensvm__update_8h.html" title="Header file for gensvm_update.c. " alt="" coords="563,80,701,107"/>
<area shape="rect" id="node3" href="gensvm__base_8h.html" title="Header file for gensvm_base.c. " alt="" coords="521,155,645,181"/>
<area shape="rect" id="node19" href="gensvm__print_8h.html" title="Header file for gensvm_print.c. " alt="" coords="648,229,771,256"/>
<area shape="rect" id="node4" href="gensvm__sparse_8h.html" title="Header file for gensvm_sparse.c. " alt="" coords="488,229,624,256"/>
<area shape="rect" id="node5" href="gensvm__globals_8h.html" title="Global definitions. " alt="" coords="562,304,702,331"/>
<area shape="rect" id="node6" href="gensvm__memory_8h.html" title="Header file for gensvm_memory.c. " alt="" coords="5,379,152,405"/>
</map>
</div>
</div>
<p><a href="gensvm__update_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:adc5be9293d3b98fd59ad50cc916f4f62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#adc5be9293d3b98fd59ad50cc916f4f62">GENSVM_BLOCK_SIZE</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:adc5be9293d3b98fd59ad50cc916f4f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae90a65a5a2a2313251356d3667a8b069"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069">gensvm_calculate_omega</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, long i)</td></tr>
<tr class="memdesc:ae90a65a5a2a2313251356d3667a8b069"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the value of omega for a single instance.  <a href="#ae90a65a5a2a2313251356d3667a8b069">More...</a><br /></td></tr>
<tr class="separator:ae90a65a5a2a2313251356d3667a8b069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb108fbbbf27aedec726d363683bdb1c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c">gensvm_majorize_is_simple</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, long i)</td></tr>
<tr class="memdesc:abb108fbbbf27aedec726d363683bdb1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we can do simple majorization for a given instance.  <a href="#abb108fbbbf27aedec726d363683bdb1c">More...</a><br /></td></tr>
<tr class="separator:abb108fbbbf27aedec726d363683bdb1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae51dd734ea3e73944d9eb890d63cb361"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361">gensvm_calculate_ab_non_simple</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, long i, long j, double *a, double *b_aq)</td></tr>
<tr class="memdesc:ae51dd734ea3e73944d9eb890d63cb361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute majorization coefficients for non-simple instance.  <a href="#ae51dd734ea3e73944d9eb890d63cb361">More...</a><br /></td></tr>
<tr class="separator:ae51dd734ea3e73944d9eb890d63cb361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9218875737267254fc332d772ce13ec0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0">gensvm_calculate_ab_simple</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, long i, long j, double *a, double *b_aq)</td></tr>
<tr class="memdesc:a9218875737267254fc332d772ce13ec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute majorization coefficients for simple instances.  <a href="#a9218875737267254fc332d772ce13ec0">More...</a><br /></td></tr>
<tr class="separator:a9218875737267254fc332d772ce13ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb327efd218c706102916bb0aa1e671d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d">gensvm_get_alpha_beta</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, long i, double *beta)</td></tr>
<tr class="memdesc:aeb327efd218c706102916bb0aa1e671d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the alpha_i and beta_i for an instance.  <a href="#aeb327efd218c706102916bb0aa1e671d">More...</a><br /></td></tr>
<tr class="separator:aeb327efd218c706102916bb0aa1e671d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21ca55554aabb785a5e0c1d8d73d01c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#a21ca55554aabb785a5e0c1d8d73d01c4">gensvm_get_update</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, struct <a class="el" href="structGenWork.html">GenWork</a> *work)</td></tr>
<tr class="memdesc:a21ca55554aabb785a5e0c1d8d73d01c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a single step of the majorization algorithm to update V.  <a href="#a21ca55554aabb785a5e0c1d8d73d01c4">More...</a><br /></td></tr>
<tr class="separator:a21ca55554aabb785a5e0c1d8d73d01c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab695778b8a796f3f991754ed0015eeb6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6">gensvm_get_ZAZ_ZB_dense</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, struct <a class="el" href="structGenWork.html">GenWork</a> *work)</td></tr>
<tr class="memdesc:ab695778b8a796f3f991754ed0015eeb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Z'*A*Z and Z'*B for dense matrices.  <a href="#ab695778b8a796f3f991754ed0015eeb6">More...</a><br /></td></tr>
<tr class="separator:ab695778b8a796f3f991754ed0015eeb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5dcf6daf6e1e1888f0a97f501037524"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524">gensvm_get_ZAZ_ZB_sparse</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, struct <a class="el" href="structGenWork.html">GenWork</a> *work)</td></tr>
<tr class="memdesc:ac5dcf6daf6e1e1888f0a97f501037524"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Z'*A*Z and Z'*B for sparse matrices.  <a href="#ac5dcf6daf6e1e1888f0a97f501037524">More...</a><br /></td></tr>
<tr class="separator:ac5dcf6daf6e1e1888f0a97f501037524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9949f0ec9eae2316998136a89aeb2992"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992">gensvm_get_ZAZ_ZB</a> (struct <a class="el" href="structGenModel.html">GenModel</a> *model, struct <a class="el" href="structGenData.html">GenData</a> *data, struct <a class="el" href="structGenWork.html">GenWork</a> *work)</td></tr>
<tr class="memdesc:a9949f0ec9eae2316998136a89aeb2992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wrapper around calculation of Z'*A*Z and Z'*B for sparse and dense.  <a href="#a9949f0ec9eae2316998136a89aeb2992">More...</a><br /></td></tr>
<tr class="separator:a9949f0ec9eae2316998136a89aeb2992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762bfc3b570c8c1007dd0c8d8a27ae0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d">dposv</a> (char UPLO, int N, int NRHS, double *A, int LDA, double *B, int LDB)</td></tr>
<tr class="memdesc:a762bfc3b570c8c1007dd0c8d8a27ae0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve AX = B where A is symmetric positive definite.  <a href="#a762bfc3b570c8c1007dd0c8d8a27ae0d">More...</a><br /></td></tr>
<tr class="separator:a762bfc3b570c8c1007dd0c8d8a27ae0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a015783619d7f097db396c176e0ff99a5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5">dsysv</a> (char UPLO, int N, int NRHS, double *A, int LDA, int *IPIV, double *B, int LDB, double *WORK, int LWORK)</td></tr>
<tr class="memdesc:a015783619d7f097db396c176e0ff99a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve a system of equations AX = B where A is symmetric.  <a href="#a015783619d7f097db396c176e0ff99a5">More...</a><br /></td></tr>
<tr class="separator:a015783619d7f097db396c176e0ff99a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for getting an update of the majorization algorithm. </p>
<dl class="section author"><dt>Author</dt><dd>G.J.J. van den Burg </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2016-10-14 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2016, G.J.J. van den Burg.</dd></dl>
<p>This file is part of GenSVM.</p>
<p>GenSVM is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.</p>
<p>GenSVM is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with GenSVM. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>. </p>

<p>Definition in file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="adc5be9293d3b98fd59ad50cc916f4f62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc5be9293d3b98fd59ad50cc916f4f62">&sect;&nbsp;</a></span>GENSVM_BLOCK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GENSVM_BLOCK_SIZE&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Number of rows in a single block for the ZAZ calculation in <a class="el" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524" title="Calculate Z&#39;*A*Z and Z&#39;*B for sparse matrices. ">gensvm_get_ZAZ_ZB_sparse()</a>. </p>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00034">34</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a762bfc3b570c8c1007dd0c8d8a27ae0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a762bfc3b570c8c1007dd0c8d8a27ae0d">&sect;&nbsp;</a></span>dposv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dposv </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>UPLO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NRHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LDA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LDB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve AX = B where A is symmetric positive definite. </p>
<p>Solve a linear system of equations AX = B where A is symmetric positive definite. This function is a wrapper for the external LAPACK routine dposv.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UPLO</td><td>which triangle of A is stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>order of A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NRHS</td><td>number of columns of B </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">A</td><td>double precision array of size (LDA, N). On exit contains the upper or lower factor of the Cholesky factorization of A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LDA</td><td>leading dimension of A </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>double precision array of size (LDB, NRHS). On exit contains the N-by-NRHS solution matrix X. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LDB</td><td>the leading dimension of B </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>info parameter which contains the status of the computation:<ul>
<li>=0: success</li>
<li>&lt;0: if -i, the i-th argument had an illegal value</li>
<li>&gt;0: if i, the leading minor of A was not positive definite</li>
</ul>
</dd></dl>
<p>See the LAPACK documentation at: <a href="http://www.netlib.org/lapack/explore-html/dc/de9/group__double_p_osolve.html">http://www.netlib.org/lapack/explore-html/dc/de9/group__double_p_osolve.html</a> </p>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00593">593</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
<a id="a015783619d7f097db396c176e0ff99a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a015783619d7f097db396c176e0ff99a5">&sect;&nbsp;</a></span>dsysv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int dsysv </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>UPLO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>NRHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LDA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>IPIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>WORK</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>LWORK</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve a system of equations AX = B where A is symmetric. </p>
<p>Solve a linear system of equations AX = B where A is symmetric. This function is a wrapper for the external LAPACK routine dsysv.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UPLO</td><td>which triangle of A is stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>order of A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NRHS</td><td>number of columns of B </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">A</td><td>double precision array of size (LDA, N). On exit contains the block diagonal matrix D and the multipliers used to obtain the factor U or L from the factorization A = U*D*U**T or A = L*D*L**T. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LDA</td><td>leading dimension of A </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IPIV</td><td>integer array containing the details of D </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">B</td><td>double precision array of size (LDB, NRHS). On exit contains the N-by-NRHS matrix X </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LDB</td><td>leading dimension of B </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">WORK</td><td>double precision array of size max(1,LWORK). On exit, WORK(1) contains the optimal LWORK </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LWORK</td><td>the length of WORK, can be used for determining the optimal blocksize for dsystrf. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>info parameter which contains the status of the computation:<ul>
<li>=0: success</li>
<li>&lt;0: if -i, the i-th argument had an illegal value</li>
<li>&gt;0: if i, D(i, i) is exactly zero, no solution can be computed.</li>
</ul>
</dd></dl>
<p>See the LAPACK documentation at: <a href="http://www.netlib.org/lapack/explore-html/d6/d0e/group__double_s_ysolve.html">http://www.netlib.org/lapack/explore-html/d6/d0e/group__double_s_ysolve.html</a> </p>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00638">638</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
<a id="ae51dd734ea3e73944d9eb890d63cb361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae51dd734ea3e73944d9eb890d63cb361">&sect;&nbsp;</a></span>gensvm_calculate_ab_non_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gensvm_calculate_ab_non_simple </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>b_aq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute majorization coefficients for non-simple instance. </p>
<p>In this function we compute the majorization coefficients needed for an instance with a non-simple majorization ( <img class="formulaInl" alt="$\varepsilon_i = 0$" src="form_18.png"/>). In this function, we distinguish a number of cases depending on the value of <a class="el" href="structGenModel.html#a5959721cc6fd6aa5bd7d688cecca6e21" title="parameter for the L-p norm in the loss function ">GenModel::p</a> and the respective value of <img class="formulaInl" alt="$\overline{q}_i^{(y_ij)}$" src="form_24.png"/>. Note that the linear coefficient is of the form <img class="formulaInl" alt="$b - a\overline{q}$" src="form_28.png"/>, but often the second term is included in the definition of <img class="formulaInl" alt="$b$" src="form_69.png"/>, so it can be optimized out. The output argument <code>b_aq</code> contains this difference therefore in one go. More details on this function can be found in the <a class="el" href="update_math.html">Implementation details for majorization steps</a>. See also <a class="el" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. ">gensvm_calculate_ab_simple()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td><a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> structure with the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index for the instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>index for the class </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*a</td><td>output argument for the quadratic coefficient </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*b_aq</td><td>output argument for the linear coefficient. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00126">126</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
<a id="a9218875737267254fc332d772ce13ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9218875737267254fc332d772ce13ec0">&sect;&nbsp;</a></span>gensvm_calculate_ab_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gensvm_calculate_ab_simple </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>b_aq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute majorization coefficients for simple instances. </p>
<p>In this function we compute the majorization coefficients needed for an instance with a simple majorization. This corresponds to the non-simple majorization for the case where <a class="el" href="structGenModel.html#a5959721cc6fd6aa5bd7d688cecca6e21" title="parameter for the L-p norm in the loss function ">GenModel::p</a> equals 1. Due to this condition the majorization coefficients are quite simple to compute. Note that the linear coefficient of the majorization is of the form <img class="formulaInl" alt="$b - a\overline{q}$" src="form_28.png"/>, but often the second term is included in the definition of <img class="formulaInl" alt="$b$" src="form_69.png"/>, so it can be optimized out. For more details see the <a class="el" href="update_math.html">Implementation details for majorization steps</a>, and <a class="el" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non-simple instance. ">gensvm_calculate_ab_non_simple()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td><a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> structure with the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index for the instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">j</td><td>index for the class </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*a</td><td>output argument for the quadratic coefficient </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*b_aq</td><td>output argument for the linear coefficient </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00183">183</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
<a id="ae90a65a5a2a2313251356d3667a8b069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae90a65a5a2a2313251356d3667a8b069">&sect;&nbsp;</a></span>gensvm_calculate_omega()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gensvm_calculate_omega </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the value of omega for a single instance. </p>
<p>This function calculates the value of the <img class="formulaInl" alt="$ \omega_i $" src="form_66.png"/> variable for a single instance, where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \omega_i = \frac{1}{p} \left( \sum_{j \neq y_i} h^p\left( \overline{q}_i^{(y_i j)} \right) \right)^{1/p-1} \]" src="form_67.png"/>
</p>
<p> Note that his function uses the precalculated values from <a class="el" href="structGenModel.html#a58e83a9391e4964c503cfe3d4f5bd9bd" title="Huber weighted error matrix. ">GenModel::H</a> and GenModel::R to speed up the computation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td><a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> structure with the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td><a class="el" href="structGenData.html" title="A structure to represent the data. ">GenData</a> structure with the data (used for y) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of the instance for which to calculate omega </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value of omega for instance i </dd></dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00056">56</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
<a id="aeb327efd218c706102916bb0aa1e671d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb327efd218c706102916bb0aa1e671d">&sect;&nbsp;</a></span>gensvm_get_alpha_beta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gensvm_get_alpha_beta </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the alpha_i and beta_i for an instance. </p>
<p>This computes the <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> value for an instance, and simultaneously updating the row of the B matrix corresponding to that instance (the <img class="formulaInl" alt="$\boldsymbol{\beta}_i'$" src="form_70.png"/>). The advantage of doing this at the same time is that we can compute the a and b values simultaneously in the <a class="el" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. ">gensvm_calculate_ab_simple()</a> and <a class="el" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non-simple instance. ">gensvm_calculate_ab_non_simple()</a> functions.</p>
<p>The computation is done by first checking whether simple majorization is possible for this instance. If so, the <img class="formulaInl" alt="$\omega_i$" src="form_71.png"/> value is set to 1.0, otherwise this value is computed. If simple majorization is possible, the coefficients a and b_aq are computed by <a class="el" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. ">gensvm_calculate_ab_simple()</a>, otherwise they're computed by <a class="el" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non-simple instance. ">gensvm_calculate_ab_non_simple()</a>. Next, the beta_i updated through the efficient BLAS daxpy function, and part of the value of <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> is computed. The final value of <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td><a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> structure with the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td><a class="el" href="structGenData.html" title="A structure to represent the data. ">GenData</a> structure with the data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of the instance to update </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">beta</td><td>beta vector of linear coefficients (assumed to be allocated elsewhere, initialized here) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> value of this instance </dd></dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00228">228</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gensvm__update_8c_aeb327efd218c706102916bb0aa1e671d_cgraph.png" border="0" usemap="#gensvm__update_8c_aeb327efd218c706102916bb0aa1e671d_cgraph" alt=""/></div>
<map name="gensvm__update_8c_aeb327efd218c706102916bb0aa1e671d_cgraph" id="gensvm__update_8c_aeb327efd218c706102916bb0aa1e671d_cgraph">
<area shape="rect" id="node2" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c" title="Check if we can do simple majorization for a given instance. " alt="" coords="253,5,409,47"/>
<area shape="rect" id="node3" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069" title="Calculate the value of omega for a single instance. " alt="" coords="235,71,427,98"/>
<area shape="rect" id="node4" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. " alt="" coords="249,123,412,164"/>
<area shape="rect" id="node5" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non&#45;simple instance. " alt="" coords="249,188,412,229"/>
</map>
</div>

</div>
</div>
<a id="a21ca55554aabb785a5e0c1d8d73d01c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21ca55554aabb785a5e0c1d8d73d01c4">&sect;&nbsp;</a></span>gensvm_get_update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gensvm_get_update </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenWork.html">GenWork</a> *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform a single step of the majorization algorithm to update V. </p>
<p>This function contains the main update calculations of the algorithm. These calculations are necessary to find a new update V. The calculations exist of recalculating the majorization coefficients for all instances and all classes, and solving a linear system to find V.</p>
<p>Because the function <a class="el" href="gensvm__update_8c.html#a21ca55554aabb785a5e0c1d8d73d01c4" title="Perform a single step of the majorization algorithm to update V. ">gensvm_get_update()</a> is always called after a call to <a class="el" href="gensvm__optimize_8h.html#a2a54331e09c9e271cb2ed6a1c389f244" title="Calculate the current value of the loss function. ">gensvm_get_loss()</a> with the same <a class="el" href="structGenModel.html#ad67883533f4bc9cc6672f6e08291c90a" title="augmented weight matrix ">GenModel::V</a>, it is unnecessary to calculate the updated errors <a class="el" href="structGenModel.html#af22da9befe368b51d369e32b13ab8d71" title="error matrix ">GenModel::Q</a> and <a class="el" href="structGenModel.html#a58e83a9391e4964c503cfe3d4f5bd9bd" title="Huber weighted error matrix. ">GenModel::H</a> here too. This saves on computation time.</p>
<p>In calculating the majorization coefficients we calculate the elements of a diagonal matrix A with elements </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_{i, i} = \frac{1}{n} \rho_i \sum_{j \neq k} \left[ \varepsilon_i a_{ijk}^{(1)} + (1 - \varepsilon_i) \omega_i a_{ijk}^{(p)} \right], \]" src="form_72.png"/>
</p>
<p> where <img class="formulaInl" alt="$ k = y_i $" src="form_73.png"/>. Since this matrix is only used to calculate the matrix <img class="formulaInl" alt="$ Z' A Z $" src="form_74.png"/>, it is efficient to update a matrix ZAZ through consecutive rank 1 updates with a single element of A and the corresponding row of Z. The BLAS function dsyr is used for this.</p>
<p>The B matrix is has rows </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \boldsymbol{\beta}_i' = \frac{1}{n} \rho_i \sum_{j \neq k} \left[ \varepsilon_i \left( b_{ijk}^{(1)} - a_{ijk}^{(1)} \overline{q}_i^{(kj)} \right) + (1 - \varepsilon_i) \omega_i \left( b_{ijk}^{(p)} - a_{ijk}^{(p)} \overline{q}_i^{(kj)} \right) \right] \boldsymbol{\delta}_{kj}' \]" src="form_75.png"/>
</p>
<p> This is also split into two cases, one for which <img class="formulaInl" alt="$ \varepsilon_i = 1 $" src="form_76.png"/>, and one for when it is 0. The 3D simplex difference matrix is used here, in the form of the <img class="formulaInl" alt="$ \boldsymbol{\delta}_{kj}' $" src="form_77.png"/>.</p>
<p>Finally, the following system is solved </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ (\textbf{Z}'\textbf{AZ} + \lambda \textbf{J})\textbf{V} = (\textbf{Z}'\textbf{AZ}\overline{\textbf{V}} + \textbf{Z}' \textbf{B}) \]" src="form_78.png"/>
</p>
<p> solving this system is done through <a class="el" href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d" title="Solve AX = B where A is symmetric positive definite. ">dposv()</a>.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Consider using CblasColMajor everywhere</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">model</td><td>model to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>data used in model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work</td><td>allocated workspace to use </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00323">323</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gensvm__update_8c_a21ca55554aabb785a5e0c1d8d73d01c4_cgraph.png" border="0" usemap="#gensvm__update_8c_a21ca55554aabb785a5e0c1d8d73d01c4_cgraph" alt=""/></div>
<map name="gensvm__update_8c_a21ca55554aabb785a5e0c1d8d73d01c4_cgraph" id="gensvm__update_8c_a21ca55554aabb785a5e0c1d8d73d01c4_cgraph">
<area shape="rect" id="node2" href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992" title="Wrapper around calculation of Z&#39;*A*Z and Z&#39;*B for sparse and dense. " alt="" coords="208,75,369,102"/>
<area shape="rect" id="node11" href="gensvm__update_8c.html#a762bfc3b570c8c1007dd0c8d8a27ae0d" title="Solve AX = B where A is symmetric positive definite. " alt="" coords="258,126,319,153"/>
<area shape="rect" id="node12" href="gensvm__print_8h.html#aede5746344fdce99647541101eaa7f06" title="Parse a formatted string and write it to standard error. " alt="" coords="269,177,309,203"/>
<area shape="rect" id="node13" href="gensvm__update_8c.html#a015783619d7f097db396c176e0ff99a5" title="Solve a system of equations AX = B where A is symmetric. " alt="" coords="259,227,319,254"/>
<area shape="rect" id="node3" href="gensvm__base_8h.html#a866ddca7070aacee709a6cfd563a595f" title="Reset all matrices of a GenWork instance. " alt="" coords="446,25,599,51"/>
<area shape="rect" id="node4" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524" title="Calculate Z&#39;*A*Z and Z&#39;*B for sparse matrices. " alt="" coords="417,75,628,102"/>
<area shape="rect" id="node10" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6" title="Calculate Z&#39;*A*Z and Z&#39;*B for dense matrices. " alt="" coords="419,126,626,153"/>
<area shape="rect" id="node5" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d" title="Compute the alpha_i and beta_i for an instance. " alt="" coords="676,101,857,127"/>
<area shape="rect" id="node6" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c" title="Check if we can do simple majorization for a given instance. " alt="" coords="923,5,1079,47"/>
<area shape="rect" id="node7" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069" title="Calculate the value of omega for a single instance. " alt="" coords="905,71,1097,98"/>
<area shape="rect" id="node8" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. " alt="" coords="920,123,1083,164"/>
<area shape="rect" id="node9" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non&#45;simple instance. " alt="" coords="920,188,1083,229"/>
</map>
</div>

</div>
</div>
<a id="a9949f0ec9eae2316998136a89aeb2992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9949f0ec9eae2316998136a89aeb2992">&sect;&nbsp;</a></span>gensvm_get_ZAZ_ZB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gensvm_get_ZAZ_ZB </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenWork.html">GenWork</a> *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wrapper around calculation of Z'*A*Z and Z'*B for sparse and dense. </p>
<p>This is a wrapper around <a class="el" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6" title="Calculate Z&#39;*A*Z and Z&#39;*B for dense matrices. ">gensvm_get_ZAZ_ZB_dense()</a> and <a class="el" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524" title="Calculate Z&#39;*A*Z and Z&#39;*B for sparse matrices. ">gensvm_get_ZAZ_ZB_sparse()</a>. See the documentation of those functions for more info.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>a <a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> struct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>a <a class="el" href="structGenData.html" title="A structure to represent the data. ">GenData</a> struct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">work</td><td>a <a class="el" href="structGenWork.html" title="A structure to hold the GenSVM workspace. ">GenWork</a> struct </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00553">553</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gensvm__update_8c_a9949f0ec9eae2316998136a89aeb2992_cgraph.png" border="0" usemap="#gensvm__update_8c_a9949f0ec9eae2316998136a89aeb2992_cgraph" alt=""/></div>
<map name="gensvm__update_8c_a9949f0ec9eae2316998136a89aeb2992_cgraph" id="gensvm__update_8c_a9949f0ec9eae2316998136a89aeb2992_cgraph">
<area shape="rect" id="node2" href="gensvm__base_8h.html#a866ddca7070aacee709a6cfd563a595f" title="Reset all matrices of a GenWork instance. " alt="" coords="243,25,397,51"/>
<area shape="rect" id="node3" href="gensvm__update_8c.html#ac5dcf6daf6e1e1888f0a97f501037524" title="Calculate Z&#39;*A*Z and Z&#39;*B for sparse matrices. " alt="" coords="215,75,425,102"/>
<area shape="rect" id="node9" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6" title="Calculate Z&#39;*A*Z and Z&#39;*B for dense matrices. " alt="" coords="217,126,423,153"/>
<area shape="rect" id="node4" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d" title="Compute the alpha_i and beta_i for an instance. " alt="" coords="473,101,655,127"/>
<area shape="rect" id="node5" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c" title="Check if we can do simple majorization for a given instance. " alt="" coords="721,5,877,47"/>
<area shape="rect" id="node6" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069" title="Calculate the value of omega for a single instance. " alt="" coords="703,71,895,98"/>
<area shape="rect" id="node7" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. " alt="" coords="717,123,880,164"/>
<area shape="rect" id="node8" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non&#45;simple instance. " alt="" coords="717,188,880,229"/>
</map>
</div>

</div>
</div>
<a id="ab695778b8a796f3f991754ed0015eeb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab695778b8a796f3f991754ed0015eeb6">&sect;&nbsp;</a></span>gensvm_get_ZAZ_ZB_dense()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gensvm_get_ZAZ_ZB_dense </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenWork.html">GenWork</a> *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Z'*A*Z and Z'*B for dense matrices. </p>
<p>This function calculates the matrices Z'<em>A*Z and Z'*B for the case where Z is stored as a dense matrix. It calculates the Z'*A*Z product by constructing a matrix LZ = (A^(1/2) * Z), and calculating (LZ)'</em>(LZ) with the BLAS dsyrk function. The matrix Z'*B is calculated with successive rank-1 updates using the BLAS dger function. These functions came out as the most efficient way to do these computations in several simulation studies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>a <a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> holding the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>a <a class="el" href="structGenData.html" title="A structure to represent the data. ">GenData</a> with the data </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">work</td><td>an allocated <a class="el" href="structGenWork.html" title="A structure to hold the GenSVM workspace. ">GenWork</a> structure, contains updated ZAZ and ZB matrices on exit. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00418">418</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gensvm__update_8c_ab695778b8a796f3f991754ed0015eeb6_cgraph.png" border="0" usemap="#gensvm__update_8c_ab695778b8a796f3f991754ed0015eeb6_cgraph" alt=""/></div>
<map name="gensvm__update_8c_ab695778b8a796f3f991754ed0015eeb6_cgraph" id="gensvm__update_8c_ab695778b8a796f3f991754ed0015eeb6_cgraph">
<area shape="rect" id="node2" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d" title="Compute the alpha_i and beta_i for an instance. " alt="" coords="260,101,441,127"/>
<area shape="rect" id="node3" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c" title="Check if we can do simple majorization for a given instance. " alt="" coords="507,5,663,47"/>
<area shape="rect" id="node4" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069" title="Calculate the value of omega for a single instance. " alt="" coords="489,71,681,98"/>
<area shape="rect" id="node5" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. " alt="" coords="504,123,667,164"/>
<area shape="rect" id="node6" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non&#45;simple instance. " alt="" coords="504,188,667,229"/>
</map>
</div>

</div>
</div>
<a id="ac5dcf6daf6e1e1888f0a97f501037524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5dcf6daf6e1e1888f0a97f501037524">&sect;&nbsp;</a></span>gensvm_get_ZAZ_ZB_sparse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gensvm_get_ZAZ_ZB_sparse </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenWork.html">GenWork</a> *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Z'*A*Z and Z'*B for sparse matrices. </p>
<p>This function calculates the matrices Z'*A*Z and Z'*B for the case where Z is stored as a CSR sparse matrix (<a class="el" href="structGenSparse.html" title="A structure to represent a sparse matrix in CSR format. ">GenSparse</a> structure). It computes only the products of the Z'*A*Z matrix that need to be computed, and updates the Z'*B matrix row-wise for each non-zero element of a row of Z, using a BLAS daxpy call.</p>
<p>This function calculates the matrix product Z'*A*Z in separate blocks, based on the number of rows defined in the GENSVM_BLOCK_SIZE variable. This is done to improve numerical precision for very large datasets. Due to rounding errors, precision can become an issue for these large datasets, when separate blocks are used and added to the result separately, this can be alleviated a little bit. See also: <a href="http://stackoverflow.com/q/40286989">http://stackoverflow.com/q/40286989</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="gensvm__update_8c.html#a9949f0ec9eae2316998136a89aeb2992" title="Wrapper around calculation of Z&#39;*A*Z and Z&#39;*B for sparse and dense. ">gensvm_get_ZAZ_ZB()</a> <a class="el" href="gensvm__update_8c.html#ab695778b8a796f3f991754ed0015eeb6" title="Calculate Z&#39;*A*Z and Z&#39;*B for dense matrices. ">gensvm_get_ZAZ_ZB_dense()</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>a <a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> holding the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>a <a class="el" href="structGenData.html" title="A structure to represent the data. ">GenData</a> with the data </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">work</td><td>an allocated <a class="el" href="structGenWork.html" title="A structure to hold the GenSVM workspace. ">GenWork</a> structure, contains updated ZAZ and ZB matrices on exit. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00481">481</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="gensvm__update_8c_ac5dcf6daf6e1e1888f0a97f501037524_cgraph.png" border="0" usemap="#gensvm__update_8c_ac5dcf6daf6e1e1888f0a97f501037524_cgraph" alt=""/></div>
<map name="gensvm__update_8c_ac5dcf6daf6e1e1888f0a97f501037524_cgraph" id="gensvm__update_8c_ac5dcf6daf6e1e1888f0a97f501037524_cgraph">
<area shape="rect" id="node2" href="gensvm__update_8c.html#aeb327efd218c706102916bb0aa1e671d" title="Compute the alpha_i and beta_i for an instance. " alt="" coords="264,101,445,127"/>
<area shape="rect" id="node3" href="gensvm__update_8c.html#abb108fbbbf27aedec726d363683bdb1c" title="Check if we can do simple majorization for a given instance. " alt="" coords="511,5,667,47"/>
<area shape="rect" id="node4" href="gensvm__update_8c.html#ae90a65a5a2a2313251356d3667a8b069" title="Calculate the value of omega for a single instance. " alt="" coords="493,71,685,98"/>
<area shape="rect" id="node5" href="gensvm__update_8c.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. " alt="" coords="508,123,671,164"/>
<area shape="rect" id="node6" href="gensvm__update_8c.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non&#45;simple instance. " alt="" coords="508,188,671,229"/>
</map>
</div>

</div>
</div>
<a id="abb108fbbbf27aedec726d363683bdb1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb108fbbbf27aedec726d363683bdb1c">&sect;&nbsp;</a></span>gensvm_majorize_is_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool gensvm_majorize_is_simple </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structGenModel.html">GenModel</a> *&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structGenData.html">GenData</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if we can do simple majorization for a given instance. </p>
<p>A simple majorization is possible if at most one of the Huberized hinge errors is nonzero for an instance. This is checked here. For this we compute the product of the Huberized error for all <img class="formulaInl" alt="$j \neq y_i$" src="form_68.png"/> and check if strictly less than 2 are nonzero. See also the <a class="el" href="update_math.html">Implementation details for majorization steps</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td><a class="el" href="structGenModel.html" title="A structure to represent a single GenSVM model. ">GenModel</a> structure with the current model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td><a class="el" href="structGenData.html" title="A structure to represent the data. ">GenData</a> structure with the data (used for y) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>index of the instance for which to check </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not we can do simple majorization </dd></dl>

<p>Definition at line <a class="el" href="gensvm__update_8c_source.html#l00089">89</a> of file <a class="el" href="gensvm__update_8c_source.html">gensvm_update.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 12 2017 14:06:19 for GenSVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
