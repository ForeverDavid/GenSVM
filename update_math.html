<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GenSVM: Implementation details for majorization steps</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GenSVM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Implementation details for majorization steps </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page explains the translation from the mathematics in the paper for computing the <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> and <img class="formulaInl" alt="$\boldsymbol{\beta_i}$" src="form_5.png"/> values, to the implementation in the code. It is here mostly for future reference and documentation purposes, you won't actually need to understand this in order to use GenSVM.</p>
<h1><a class="anchor" id="alpha_i"></a>
Computation of the quadratic coefficients</h1>
<p>We start our analysis with the computation of the <img class="formulaInl" alt="$ \alpha_i $" src="form_6.png"/>:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha_i = \frac{1}{n} \rho_i \sum_{j \neq y_i} \left[ \varepsilon_i a_{ijy_i}^{(1)} + (1 - \varepsilon_i) \omega_i a_{ijy_i}^{(p)} \right] \]" src="form_7.png"/>
</p>
<p> Since in the code in gensvm_get_Avalue_update_B() we work with a condition on the <img class="formulaInl" alt="$\varepsilon_i$" src="form_8.png"/>, we will write the <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> using this condition as well: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha_i = \begin{dcases} \frac{1}{n} \rho_i \sum_{j \neq y_i} a_{ijy_i}^{(1)} &amp; \text{ if } \varepsilon_i = 1 \\ \frac{1}{n} \rho_i \omega_i \sum_{j \neq y_i} a_{ijy_i}^{(p)} &amp; \text{ if } \varepsilon_i = 0 \end{dcases} \]" src="form_9.png"/>
</p>
<p> Now, if <img class="formulaInl" alt="$\varepsilon_i = 1$" src="form_10.png"/>, we need to calculate the <img class="formulaInl" alt="$a_{ijy_i}^{(1)}$" src="form_11.png"/>, corresponding to <img class="formulaInl" alt="$p = 1$" src="form_12.png"/>. From the overview of quadratic majorization coefficients given in the paper, we see that there are five regions for the coefficient depending on the value of <img class="formulaInl" alt="$\overline{q}_i^{(y_ij})$" src="form_13.png"/> and <img class="formulaInl" alt="$p$" src="form_14.png"/>. However, with <img class="formulaInl" alt="$p = 1$" src="form_12.png"/>, this reduces to three regions, since <img class="formulaInl" alt="$(p + \kappa - 1)/(p - 2) = -\kappa$" src="form_15.png"/> if <img class="formulaInl" alt="$p = 1$" src="form_12.png"/>. Plugging in <img class="formulaInl" alt="$p = 1$" src="form_12.png"/> in the formulas from the table yields the following expressions for <img class="formulaInl" alt="$a_{ijy_i}^{(1)}$" src="form_11.png"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a_{ijy_i}^{(1)} = \begin{dcases} \frac{1}{4} \left( 1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2} \right)^{-1} &amp; \text{ if } \overline{q}_i^{(y_ij)} \leq -\kappa \\ \frac{1}{2(\kappa + 1)} &amp; \text{ if } \overline{q}_i^{(y_ij)} \in (-\kappa, 1] \\ -\frac{1}{4} \left( 1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2} \right)^{-1} &amp; \text{ if } \overline{q}_i^{(y_ij)} &gt; 1 \end{dcases} \]" src="form_16.png"/>
</p>
<p> These coefficients should correspond to the coefficients for <img class="formulaInl" alt="$a$" src="form_17.png"/> as calculated in <a class="el" href="gensvm__update_8h.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. ">gensvm_calculate_ab_simple()</a>.</p>
<p>If <img class="formulaInl" alt="$\varepsilon_i = 0$" src="form_18.png"/>, we need to calculate <img class="formulaInl" alt="$a_{ijy_i}^{(p)}$" src="form_19.png"/>. Here, we distinguish two cases depending on the value of <img class="formulaInl" alt="$p$" src="form_14.png"/>. If <img class="formulaInl" alt="$p = 2 $" src="form_20.png"/>, the value of <img class="formulaInl" alt="$a_{ijy_i}^{(2)}$" src="form_21.png"/> is the same everywhere, and equal to 1.5. Otherwise, if <img class="formulaInl" alt="$p &lt; 2$" src="form_22.png"/>, we have </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ a_{ijy_i}^{(p)} = \begin{dcases} \frac{1}{4} p^2 \left( 1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2} \right)^{p - 2} &amp; \text{ if } \overline{q}_i^{(y_ij)} \leq \frac{p + \kappa - 1}{p - 2} \\ \frac{1}{4} p (2p - 1) \left( \frac{\kappa + 1}{2} \right)^{p - 2} &amp; \text{ if } \overline{q}_i^{(y_ij)} \in \left( \left. \frac{p + \kappa - 1}{p - 2}, 1 \right. \right] \\ \frac{1}{4} p^2 \left( \frac{p}{p - 2} \left( 1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2}\right) \right)^{p - 2} &amp; \text{ if } \overline{q}_i^{(y_ij)} &gt; 1 \end{dcases} \]" src="form_23.png"/>
</p>
<p> Note that in the second case the expression is independent of <img class="formulaInl" alt="$\overline{q}_i^{(y_ij)}$" src="form_24.png"/>, so this value can be cached. These expressions for <img class="formulaInl" alt="$a_{ijy_i}^{(p)}$" src="form_19.png"/> are reflected in <a class="el" href="gensvm__update_8h.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non-simple instance. ">gensvm_calculate_ab_non_simple()</a>.</p>
<h1><a class="anchor" id="beta_i"></a>
Computation of the linear coefficients</h1>
<p>We continue the analysis with the computation of the <img class="formulaInl" alt="$\boldsymbol{\beta}_i$" src="form_25.png"/> vectors. These vectors are given by the expression: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \boldsymbol{\beta}_i' = \frac{1}{n}\rho_i \sum_{j \neq y_i} \left[ \varepsilon_i \left( b_{ijy_i}^{(1)} - a_{ijy_i}^{(1)}\overline{q}_i^{(y_ij)} \right) + (1 - \varepsilon_i) \omega_i \left( b_{ijy_i}^{(p)} - a_{ijy_i}^{(p)}\overline{q}_i^{(y_ij)} \right) \right] \boldsymbol{\delta}_{y_ij}' \]" src="form_26.png"/>
</p>
<p> Similarly to the <img class="formulaInl" alt="$\alpha_i$" src="form_4.png"/> above, we can write this in two cases depending on <img class="formulaInl" alt="$\varepsilon_i$" src="form_8.png"/>:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \boldsymbol{\beta}_i' = \begin{dcases} \frac{1}{n}\rho_i \sum_{j \neq y_i} \left( b_{ijy_i}^{(1)} - a_{ijy_i}^{(1)}\overline{q}_i^{(y_ij)} \right) \boldsymbol{\delta}_{y_ij}' &amp; \text{ if } \varepsilon_i = 1 \\ \frac{1}{n}\rho_i \omega_i \sum_{j \neq y_i} \left( b_{ijy_i}^{(p)} - a_{ijy_i}^{(p)}\overline{q}_i^{(y_ij)} \right) \boldsymbol{\delta}_{y_ij}' &amp; \text{ if } \varepsilon_i = 0 \end{dcases} \]" src="form_27.png"/>
</p>
<p>In the code we directly compute the differences of the form <img class="formulaInl" alt="$b - a\overline{q}$" src="form_28.png"/>, since this is saves some computations. We therefore work out the values of these expressions below.</p>
<p>First, for <img class="formulaInl" alt="$\varepsilon = 1$" src="form_29.png"/> we have, after plugging in <img class="formulaInl" alt="$p = 1$" src="form_12.png"/> and rearranging: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_{ijy_i}^{(1)} - a_{ijy_i}^{(1)}\overline{q}_i^{(y_ij)} = \begin{dcases} \frac{1}{2} &amp; \text{ if } \overline{q}_i^{(y_ij)} \leq -\kappa \\ a_{ijy_i}^{(1)} \left( 1 - \overline{q}_i^{(y_ij)} \right) &amp; \text{ if } \overline{q}_i^{(y_ij)} \in (-\kappa, 1] \\ 0 &amp; \text{ if } \overline{q}_i^{(y_ij)} &gt; 1 \end{dcases} \]" src="form_30.png"/>
</p>
<p> (the final 0 may be surprising, but can be found when plugging in the value of <img class="formulaInl" alt="$a_{ijy_i}^{(1)}$" src="form_11.png"/>). The above coefficients for this difference are reflected in <a class="el" href="gensvm__update_8h.html#a9218875737267254fc332d772ce13ec0" title="Compute majorization coefficients for simple instances. ">gensvm_calculate_ab_simple()</a>.</p>
<p>Now for <img class="formulaInl" alt="$\varepsilon_i = 0$" src="form_18.png"/>, we first have the case where <img class="formulaInl" alt="$p &lt; 2$" src="form_22.png"/>, then </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_{ijy_i}^{(p)} - a_{ijy_i}^{(p)}\overline{q}_i^{(y_ij)} = \begin{dcases} \frac{1}{2}p\left( 1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2}\right)^{p-1} &amp; \text{ if } \overline{q}_i^{(y_ij)} \leq -\kappa \\ \frac{p \left(1 - \overline{q}_i^{(y_ij)} \right)^{2p-1}}{ \left(2(\kappa + 1)\right)^p} &amp; \text{ if } \overline{q}_i^{(y_ij)} \in (-\kappa, 1] \\ a_{ijy_i}^{(p)} \left( \frac{2\overline{q}_i^{(y_ij)} + \kappa - 1}{p - 2} \right) + \frac{1}{2} p \left( \frac{p}{p - 2} \left(1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2} \right) \right)^{p - 1} &amp; \text{ if } \overline{q}_i^{(y_ij)} &gt; 1 \end{dcases} \]" src="form_31.png"/>
</p>
<p> Second, we have the case where <img class="formulaInl" alt="$ p = 2$" src="form_32.png"/>, in that case: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ b_{ijy_i}^{(2)} - a_{ijy_i}^{(2)}\overline{q}_i^{(y_ij)} = \begin{dcases} 1 - \overline{q}_i^{(y_ij)} - \frac{\kappa + 1}{2} &amp; \text{ if } \overline{q}_i^{(y_ij)} \leq -\kappa \\ \frac{1}{2(\kappa+1)^2}\left( 1 - \overline{q}_i^{(y_ij)} \right)^3 &amp; \text{ if } \overline{q}_i^{(y_ij)} \in (-\kappa, 1] \\ 0 &amp; \text{ if } \overline{q}_i^{(y_ij)} &gt; 1 \end{dcases} \]" src="form_33.png"/>
</p>
<p> These coefficients are all calculated in <a class="el" href="gensvm__update_8h.html#ae51dd734ea3e73944d9eb890d63cb361" title="Compute majorization coefficients for non-simple instance. ">gensvm_calculate_ab_non_simple()</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 21 2017 18:44:22 for GenSVM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
